import{_ as T,f as $,i as D,j as L}from"./_plugin-vue_export-helper-fxonzzrb.js";import{m as P,o as m,c as b,a as l,b as n,w as s,t as r,I as R,s as U,r as i,e as c,J as j,i as h,q,p as x,E as S}from"./index-Dyl5uCa_.js";const z={class:"settings-view"},G={class:"section-card"},H={class:"section-card"},J={class:"section-header"},F={class:"section-hint"},K={key:0,class:"seasons-badge"},O={key:0,class:"regrow-hint"},Q={class:"exp-value"},W={__name:"AccountSettings",props:{uin:String},setup(C){const y=C,d=c(1),f=c(10),v=c(!1),_=c(1),w=c([]),p=c(!1);async function V(){var a;try{const o=(await $(y.uin)).data;d.value=Math.round((o.farmInterval||1e3)/1e3),f.value=Math.round((o.friendInterval||1e4)/1e3),_.value=((a=o.userState)==null?void 0:a.level)||1}catch{}}async function I(){v.value=!0;try{await L(y.uin,{farmInterval:d.value*1e3,friendInterval:f.value*1e3}),S.success("配置已保存")}catch(a){S.error(a.message)}finally{v.value=!1}}async function M(){p.value=!0;try{const a=await D(_.value);w.value=a.data||[]}catch{}finally{p.value=!1}}function k(a){if(!a)return"-";if(a<60)return`${a}秒`;if(a<3600)return`${Math.floor(a/60)}分${a%60}秒`;const t=Math.floor(a/3600),o=Math.floor(a%3600/60);return o>0?`${t}小时${o}分`:`${t}小时`}return P(async()=>{await V(),M()}),(a,t)=>{const o=i("el-input-number"),g=i("el-form-item"),A=i("el-button"),B=i("el-form"),u=i("el-table-column"),E=i("el-table"),N=j("loading");return m(),b("div",z,[l("div",G,[t[5]||(t[5]=l("h3",{class:"section-title"},"参数配置",-1)),n(B,{"label-width":"120px",class:"config-form"},{default:s(()=>[n(g,{label:"农场巡查间隔"},{default:s(()=>[n(o,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),min:1,max:3600,step:1},null,8,["modelValue"]),t[2]||(t[2]=l("span",{class:"unit"},"秒 (最低1秒)",-1))]),_:1}),n(g,{label:"好友巡查间隔"},{default:s(()=>[n(o,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=e=>f.value=e),min:1,max:3600,step:1},null,8,["modelValue"]),t[3]||(t[3]=l("span",{class:"unit"},"秒 (最低1秒)",-1))]),_:1}),n(g,null,{default:s(()=>[n(A,{type:"primary",onClick:I,loading:v.value},{default:s(()=>[...t[4]||(t[4]=[h("保存配置",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),l("div",H,[l("div",J,[t[6]||(t[6]=l("h3",{class:"section-title"},"种植效率排行",-1)),l("span",F,"基于当前等级(Lv"+r(_.value)+")可购买作物计算",1)]),R((m(),U(E,{data:w.value,stripe:"",style:{width:"100%"},"header-cell-style":{background:"var(--bg-base)",color:"var(--text-muted)",borderColor:"var(--border)"},"cell-style":{background:"var(--bg-surface)",color:"var(--text-secondary)",borderColor:"var(--border)"}},{default:s(()=>[n(u,{label:"排名",width:"60",align:"center"},{default:s(({$index:e})=>[l("span",{class:q({"rank-star":e===0})},r(e+1)+r(e===0?" ★":""),3)]),_:1}),n(u,{label:"作物",width:"120",align:"center"},{default:s(({row:e})=>[h(r(e.name),1),e.seasons>1?(m(),b("span",K,"×"+r(e.seasons)+"季",1)):x("",!0)]),_:1}),n(u,{label:"生长周期",width:"130",align:"center"},{default:s(({row:e})=>[l("span",null,r(k(e.totalTimeSec||e.growTimeSec)),1),e.regrowSec?(m(),b("span",O,"(含回生"+r(k(e.regrowSec))+")",1)):x("",!0)]),_:1}),n(u,{label:"总经验",width:"90",align:"center"},{default:s(({row:e})=>[h(r(e.totalExp||e.exp),1)]),_:1}),n(u,{label:"经验/小时",width:"110",align:"center"},{default:s(({row:e})=>[l("span",Q,r(e.expPerHour),1)]),_:1})]),_:1},8,["data"])),[[N,p.value]])])])}}},Z=T(W,[["__scopeId","data-v-61dd017b"]]);export{Z as default};
