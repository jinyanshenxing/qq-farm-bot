import{H as f,e as l,x as n}from"./index-Dyl5uCa_.js";import{l as v,e as S}from"./_plugin-vue_export-helper-fxonzzrb.js";const I=f("auth",()=>{const o=l(localStorage.getItem("token")||""),t=l(JSON.parse(localStorage.getItem("user")||"null")),u=n(()=>!!o.value),c=n(()=>{var e;return((e=t.value)==null?void 0:e.role)==="admin"}),i=n(()=>{var e;return((e=t.value)==null?void 0:e.username)||""}),m=n(()=>{var r;return(((r=t.value)==null?void 0:r.allowedUins)||"").split(",").map(a=>a.trim()).filter(Boolean)});async function g(e,r){const a=await v(e,r);return o.value=a.data.token,t.value=a.data.user,localStorage.setItem("token",a.data.token),localStorage.setItem("user",JSON.stringify(a.data.user)),a.data}function s(){o.value="",t.value=null,localStorage.removeItem("token"),localStorage.removeItem("user")}async function d(){if(!o.value)return!1;try{const e=await S();return t.value=e.data,!0}catch{return s(),!1}}return{token:o,user:t,isLoggedIn:u,isAdmin:c,username:i,allowedUins:m,login:g,logout:s,checkAuth:d}});export{I as u};
